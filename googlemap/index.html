<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>google map dht</title>
  <script src="https://webduino.io/components/webduino-js/dist/webduino-all.min.js"></script>
  <script src="https://blockly.webduino.io/webduino-blockly.js"></script>
  <style>
  html,
  body {
    height: 100%;
    margin: 0;
    padding: 0;
  }
  
  #map {
  	width:100%;
    height: 100%;
  }
  .mapMarker{
  	line-height: 20px;
  }
  .mapMarker h3 {
    margin: 5px 0 8px 0;
    padding: 5px 0 8px 0;
    border-bottom: 1px solid #ccc;
  }
  </style>
</head>

<body>

  <div id="map"></div>

  <script type="text/javascript">
  var map;

  function initialize() {
    map = new google.maps.Map(document.getElementById('map'), {
      zoom: 15
    });
    var beaches = [
      ['獅甲國小', '獅甲國小','a1'],
      ['高雄市前鎮區復興四路 12 號', '高雄軟體園區','a2'],
      ['獅甲捷運站', '獅甲捷運站','a3'],
      ['勞工公園', '勞工公園','a4'],
      ['高雄 85 大樓', '高雄 85 大樓','a5']
    ];
    setCenter(beaches[2][0]);
    for (var i = 0; i < beaches.length; i++) {
      var beach = beaches[i];
      var marker = new google.maps.Marker({
        map: map,
        title: beach[0],
        zIndex: i,
      });
      GetAddressMarker(beach[0], beach[1], beach[2]);
    }

    boardOnline();
  }

  function setCenter(address) {
    var marker = new google.maps.Marker({
      map: map
    });
    geocoder = new google.maps.Geocoder();
    geocoder.geocode({
      address: address
    }, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        LatLng = results[0].geometry.location;
        map.setCenter(LatLng);
      }
    });
  }


  function GetAddressMarker(address, title, name) {
    var marker = new google.maps.Marker({
      map: map
    });
    geocoder = new google.maps.Geocoder();
    geocoder.geocode({
      address: address
    }, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        LatLng = results[0].geometry.location;
        marker.setPosition(LatLng);
        console.log("【地址位置】緯度：" + LatLng.lat() + "經度：" + LatLng.lng());

        var infowindow = new google.maps.InfoWindow({
          content: '<div class="mapMarker ' + name + '"><h3>' + title + '</h3><span class="tt"></span><br/><span class="hh"></span></div>'
        });

        infowindow.open(map, marker);
        marker.addListener('click', function() {
          infowindow.open(map, marker);
        });

      }
    });
  }

  function boardOnline(){

  	var timer = 1;

		boardReady('JVXX', function (board) {
			console.log('JVXX');
		  board.systemReset();
		  board.samplingInterval = 250;
		  var dht = getDht(board, 11);
		  var show_t = document.querySelectorAll(".a1 .tt");
		  var show_h = document.querySelectorAll(".a1 .hh");
		  dht.read(function(evt){
		    show_t[0].innerHTML = '溫度：' + dht.temperature + '度';
		    show_h[0].innerHTML = '濕度：' + dht.humidity + '%';
				console.log('JVXX : '+dht.temperature);
		  }, timer*1000);
		});

		boardReady('OVXD', function (board) {
			console.log('OVXD');
		  board.systemReset();
		  board.samplingInterval = 250;
		  var dht = getDht(board, 11);
		  var show_t = document.querySelectorAll(".a2 .tt");
		  var show_h = document.querySelectorAll(".a2 .hh");
		  dht.read(function(evt){
		    show_t[0].innerHTML = '溫度：' + dht.temperature + '度';
		    show_h[0].innerHTML = '濕度：' + dht.humidity + '%';
				console.log('OVXD : '+dht.temperature);
		  }, timer*1000);
		});

		boardReady('7dJW', function (board) {
			console.log('7dJW');
		  board.systemReset();
		  board.samplingInterval = 250;
		  var dht = getDht(board, 11);
		  var show_t = document.querySelectorAll(".a3 .tt");
		  var show_h = document.querySelectorAll(".a3 .hh");
		  dht.read(function(evt){
		    show_t[0].innerHTML = '溫度：' + dht.temperature + '度';
		    show_h[0].innerHTML = '濕度：' + dht.humidity + '%';
				console.log('7dJW : '+dht.temperature);
		  }, timer*1000);
		});

  }

  </script>
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB6TBwRrd2pQeyD0COblf4uADkO1EMjSCw&callback=initialize">
  </script>
</body>

</html>
